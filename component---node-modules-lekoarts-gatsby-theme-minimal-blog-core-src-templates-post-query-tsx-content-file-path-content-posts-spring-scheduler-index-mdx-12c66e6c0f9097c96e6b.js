"use strict";(self.webpackChunkminimal_blog=self.webpackChunkminimal_blog||[]).push([[443],{4765:function(e,n,a){a.d(n,{F:function(){return p},Z:function(){return g}});var t=a(7294),l=a(8733),i=a(795),c=a(1521),r=a(6799),s=a(8871);var A=e=>{let{post:n}=e;return null};const o=["16px","8px","4px"].map((e=>"rgba(0, 0, 0, 0.1) 0px "+e+" "+e+" 0px"));var d=e=>{let{data:{post:n},children:a}=e;return(0,l.tZ)(c.Z,null,(0,l.tZ)(i.X6,{as:"h1",variant:"styles.h1"},n.title),(0,l.tZ)("p",{sx:{color:"secondary",mt:3,a:{color:"secondary"},fontSize:[1,1,2]}},(0,l.tZ)("time",null,n.date),n.tags&&(0,l.tZ)(t.Fragment,null," — ",(0,l.tZ)(r.Z,{tags:n.tags})),n.timeToRead&&" — ",n.timeToRead&&(0,l.tZ)("span",null,n.timeToRead," min read")),(0,l.tZ)("section",{sx:{my:5,".gatsby-resp-image-wrapper":{my:[4,4,5],borderRadius:"4px",boxShadow:o.join(", "),".gatsby-resp-image-image":{borderRadius:"4px"}},variant:"layout.content"}},a),(0,l.tZ)(A,{post:n}))};const p=e=>{var n,a,t;let{data:{post:i}}=e;return(0,l.tZ)(s.Z,{title:i.title,description:i.description?i.description:i.excerpt,image:i.banner?null===(n=i.banner)||void 0===n||null===(a=n.childImageSharp)||void 0===a||null===(t=a.resize)||void 0===t?void 0:t.src:void 0,pathname:i.slug,canonicalUrl:i.canonicalUrl})};function g(e){let{...n}=e;return t.createElement(d,n)}},6799:function(e,n,a){var t=a(8733),l=a(7294),i=a(1883),c=a(3494),r=a(9706);n.Z=e=>{let{tags:n}=e;const{tagsPath:a,basePath:s}=(0,c.Z)();return(0,t.tZ)(l.Fragment,null,n.map(((e,n)=>(0,t.tZ)(l.Fragment,{key:e.slug},!!n&&", ",(0,t.tZ)(i.Link,{sx:e=>{var n;return{...null===(n=e.styles)||void 0===n?void 0:n.a}},to:(0,r.Z)("/"+s+"/"+a+"/"+e.slug)},e.name)))))}},8871:function(e,n,a){var t=a(7294),l=a(1883),i=a(4232);n.Z=e=>{let{title:n="",description:a="",pathname:c="",image:r="",children:s=null,canonicalUrl:A=""}=e;const o=(0,i.Z)(),{siteTitle:d,siteTitleAlt:p,siteUrl:g,siteDescription:m,siteImage:u,author:b,siteLanguage:f}=o,E={title:n?n+" | "+d:p,description:a||m,url:""+g+(c||""),image:""+g+(r||u)};return t.createElement(t.Fragment,null,t.createElement("html",{lang:f}),t.createElement("title",null,E.title),t.createElement("meta",{name:"description",content:E.description}),t.createElement("meta",{name:"image",content:E.image}),t.createElement("meta",{property:"og:title",content:E.title}),t.createElement("meta",{property:"og:url",content:E.url}),t.createElement("meta",{property:"og:description",content:E.description}),t.createElement("meta",{property:"og:image",content:E.image}),t.createElement("meta",{property:"og:type",content:"website"}),t.createElement("meta",{property:"og:image:alt",content:E.description}),t.createElement("meta",{name:"twitter:card",content:"summary_large_image"}),t.createElement("meta",{name:"twitter:title",content:E.title}),t.createElement("meta",{name:"twitter:url",content:E.url}),t.createElement("meta",{name:"twitter:description",content:E.description}),t.createElement("meta",{name:"twitter:image",content:E.image}),t.createElement("meta",{name:"twitter:image:alt",content:E.description}),t.createElement("meta",{name:"twitter:creator",content:b}),t.createElement("meta",{name:"gatsby-theme",content:"@lekoarts/gatsby-theme-minimal-blog"}),t.createElement("link",{rel:"icon",type:"image/png",sizes:"32x32",href:(0,l.withPrefix)("/favicon-32x32.png")}),t.createElement("link",{rel:"icon",type:"image/png",sizes:"16x16",href:(0,l.withPrefix)("/favicon-16x16.png")}),t.createElement("link",{rel:"apple-touch-icon",sizes:"180x180",href:(0,l.withPrefix)("/apple-touch-icon.png")}),A?t.createElement("link",{rel:"canonical",href:A}):null,s)}},2324:function(e,n,a){a.r(n),a.d(n,{Head:function(){return r.F},default:function(){return s}});var t=a(7294),l=a(1151);function i(e){const n=Object.assign({h2:"h2",hr:"hr",h4:"h4",p:"p",ol:"ol",li:"li",h3:"h3",ul:"ul",pre:"pre",code:"code",span:"span",a:"a"},(0,l.ah)(),e.components);return t.createElement(t.Fragment,null,t.createElement(n.h2,null,"Spring Scheduler 를 활용한 작업 Scheduling"),"\n",t.createElement(n.hr),"\n",t.createElement(n.h4,null,"들어가기에 앞서"),"\n",t.createElement(n.p,null,"짧은 간격으로 주기적으로 이루어져야 하는 작업들이 있다. 이때 Spring Batch 를 떠올릴 수 있지만,\n매우 간단하거나 실행 되어야 하는 주기가 10분, 30분, 1시간 정도로 짧은 편에 속하며 처리하는 데이터의 수가 매우 많지 않다면\nSpring Batch 를 적용하는 것이 부담스럽고, 이는 곧 비교적 과도한 리소스 소모에 대한 걱정으로 이어질 수 있다.\n이럴 때 적절하게 적용할 수 있는 Spring Scheduler 에 대해서 알아보자."),"\n",t.createElement(n.hr),"\n",t.createElement(n.h4,null,"Our Goals"),"\n",t.createElement(n.ol,null,"\n",t.createElement(n.li,null,"Spring Scheduler 동작에 대한 이해"),"\n",t.createElement(n.li,null,"Spring Scheduler 적용 방법"),"\n",t.createElement(n.li,null,"주의 할 점"),"\n"),"\n",t.createElement(n.hr),"\n",t.createElement(n.h2,null,"설정"),"\n",t.createElement(n.h3,null,"환경"),"\n",t.createElement(n.ul,null,"\n",t.createElement(n.li,null,"Spring Boot 2.5.6"),"\n",t.createElement(n.li,null,"Gradle 7.6.1"),"\n",t.createElement(n.li,null,"Java 11"),"\n"),"\n",t.createElement("br"),"\n",t.createElement(n.h3,null,"의존성"),"\n",t.createElement(n.pre,null,t.createElement(n.code,null,"dependencies {\n    implementation 'org.springframework.boot:spring-boot-starter-web'\n}\n")),"\n",t.createElement(n.p,null,"이 의존성에 Spring Scheduler(org.springframework.scheduling) 가 포함되어 있다."),"\n",t.createElement(n.h3,null,"활성화"),"\n",t.createElement(n.p,null,"어플리케이션 메인 클래스에 ",t.createElement(n.code,null,"@EnableScheduling")," 어노테이션을 달아서 Spring Scheduler 를 사용할 것임을 어플리케이션에게 알려주어야 한다."),"\n",t.createElement(n.pre,null,t.createElement(n.code,{className:"language-java"},"@EnableScheduling\n@SpringBootApplication\npublic class SchedulerApplication {\n\t\n\tpublic static void main(String[] args) {\n\t\tSpringApplication.run(SchedulerApplication.class, args);\n\t}\n}\n")),"\n",t.createElement(n.p,null,"그리고 실제 수행되어야 할 메서드에 스케줄링 옵션 값과 함께 ",t.createElement(n.code,null,"@Scheduled")," 어노테이션을 달아주어야 하고\n메서드의 클래스는 Bean 으로 등록되어야 한다."),"\n",t.createElement(n.p,null,"스케줄링 작동에 필요한 모든 준비가 완료 된 클래스와 메서드의 형태는 아래와 같다."),"\n",t.createElement(n.pre,null,t.createElement(n.code,{className:"language-java"},'@Slf4j\n@Component\npublic class SchedulerExampleJob {\n    private static final String CRON_EXPRESSION_EXAMPLE = "30 * * * * *";\n\n    @Scheduled(cron = CRON_EXPRESSION_EXAMPLE)\n    public void cron() {\n        log.info(">>>>>시작 시간 {}", LocalDateTime.now().format(DATE_TIME_FORMATTER));\n    }\n}\n')),"\n",t.createElement(n.p,null,"예제라서 간단하게 구현했지만, 실제 수행되어야 하는 비즈니스 로직은 다른 Bean 의 메서드로 분리하는게 좋다. 즉 다시 말해,\n스케줄링 하여 작업을 실행하는 Bean 과 비즈니스 로직을 수행하는 Bean 이 분리된 형태이다."),"\n",t.createElement(n.p,null,"비즈니스 로직에는 ",t.createElement(n.code,null,"@Transactional")," 이나 ",t.createElement(n.code,null,"@Async")," 와 같은 어노테이션을 붙여 추가적인 기능들을 필요로 하는 경우가 많은데\n이런 어노테이션들을 @Scheduled 와 같은 메소드에 선언하게 되면\n",t.createElement(n.code,null,"@Scheduled")," 어노테이션에 의한 동작과 충돌을 일으킬 수 있기 때문이다. 또한 객체의 역할,책임 관점에서도 분리하는게 좋은데\n자세한 내용은 다른 포스팅에서 다루어 볼 예정이다."),"\n",t.createElement(n.h3,null,"Thread Pool"),"\n",t.createElement(n.p,null,"Default 로 Scheduler 에 사용되는 Thread Pool의 사이즈는 1이다. 이렇게 되면 특정 작업이 제 시간에 동작하지 않고\n이미 작업중인 것이 끝날 때까지 기다려야 한다는 문제가 발생한다."),"\n",t.createElement(n.pre,null,t.createElement(n.code,{className:"language-java"},'@Scheduled(fixedRate = 3000)\npublic void fixedRate1() throws InterruptedException {\n    log.info(">>>>>fixedRate1 시작 시간 {}", LocalDateTime.now().format(DATE_TIME_FORMATTER));\n    Thread.sleep(5000);\n}\n\n@Scheduled(fixedRate = 3000)\npublic void fixedRate2() throws InterruptedException {\n    log.info(">>>>>fixedRate2 시작 시간 {}", LocalDateTime.now().format(DATE_TIME_FORMATTER));\n    Thread.sleep(5000);\n}\n')),"\n",t.createElement(n.p,null,"위의 메소드들은 각각 따로 3초마다 실행되어야 하지만 이용할 수 있는 Thread가 1개이다 보니 이전 작업의 종료까지 기다리기 때문에\n5초마다 번갈아가며 수행된다."),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 952px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 12.916666666666664%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAuUlEQVR42iXNXU6EMAAAYS5kWEookLWwbfkrFBYohBiN3v8UY1yf5u2bSFUO3XhE9UCkA2/xnfdqoB828ntLoh2pnRBmRNiJtPGk3UJcGMqyYXCBWk88rH81Ms2Cbmcya5ByIU4Utn2yh0+Umcj8Tu4PsnFD+kD+PCm2C6E66npkC1/0bqftN9puJfo7dG5FdpY8X7klirZfOc5vlPFk8z8i54CcD4r1ogwfiHpA64nz+sGNB246XvAvXjZsPGz63s8AAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="thread-pool-size-1"\n        title=""\n        src="/static/426e9e98249d5984678331a8c125abb0/35c50/thread-pool-size-1.png"\n        srcset="/static/426e9e98249d5984678331a8c125abb0/5243c/thread-pool-size-1.png 240w,\n/static/426e9e98249d5984678331a8c125abb0/ab158/thread-pool-size-1.png 480w,\n/static/426e9e98249d5984678331a8c125abb0/35c50/thread-pool-size-1.png 952w"\n        sizes="(max-width: 952px) 100vw, 952px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\n",t.createElement(n.p,null,"따라서 상황과 여건에 맞게 적절한 Thread Pool 사이즈를 설정하는 작업이 필요하다."),"\n",t.createElement(n.p,null,t.createElement(n.code,null,"application.properties")," 에 다음과 같이 값을 설정할 수 있다."),"\n",t.createElement(n.p,null,t.createElement(n.code,null,"spring.task.scheduling.pool.size=5")),"\n",t.createElement(n.p,null,"혹은 Configuration 클래스를 만들어서 정의할 수도 있다."),"\n",t.createElement(n.pre,null,t.createElement(n.code,{className:"language-java"},'@Configuration\npublic class SchedulerConfig implements SchedulingConfigurer {\n    private static final int POOL_SIZE = 5;\n\n    @Override\n    public void configureTasks(ScheduledTaskRegistrar taskRegistrar) {\n        ThreadPoolTaskScheduler threadPoolTaskScheduler = new ThreadPoolTaskScheduler();\n        threadPoolTaskScheduler.setPoolSize(POOL_SIZE);\n        threadPoolTaskScheduler.setThreadNamePrefix("쓰레드-");\n        threadPoolTaskScheduler.initialize();\n\n        taskRegistrar.setTaskScheduler(threadPoolTaskScheduler);\n    }\n}\n')),"\n",t.createElement(n.p,null,"설정 한 후 다시 작업을 실행시키면"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 12.083333333333332%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAiElEQVR42hXL0Q6CIABAUX+m5muJmbkVooiIIpqZbbX1/z9xW+f9RG5YkapHVZ6i1qSFQ4iafZwgS4fUnmPdI8yIaDxpG0j7mUNRI6Xj/yvtUdWAVI5oXj5oE7B24eYs52sgywy7OEE3Ae0WTuODfHqSjSv5/cVleyPKjtbOrNsX2y2YdkabiR+BrEiWCF7ZLAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="thread-pool-size-5"\n        title=""\n        src="/static/f64630418180a31e98cf83879168b73b/7d769/thread-pool-size-5.png"\n        srcset="/static/f64630418180a31e98cf83879168b73b/5243c/thread-pool-size-5.png 240w,\n/static/f64630418180a31e98cf83879168b73b/ab158/thread-pool-size-5.png 480w,\n/static/f64630418180a31e98cf83879168b73b/7d769/thread-pool-size-5.png 960w,\n/static/f64630418180a31e98cf83879168b73b/bcba3/thread-pool-size-5.png 975w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\n",t.createElement(n.p,null,"다음과 같이 적절하게 여러 Thread 중 쉬고있는 하나를 선택하여 실행되는 것을 확인할 수 있다."),"\n",t.createElement(n.h2,null,"스케줄링"),"\n",t.createElement(n.p,null,"지원되는 스케줄링 방식에는 여러가지가 있는데 Cron 부터 천천히 알아보자.\n참고로 앞으로 나오는 결과 화면에서 등장하는 시간 형식은 ",t.createElement(n.code,null,"HH:mm:ss")," 이다."),"\n",t.createElement(n.h3,null,"Cron"),"\n",t.createElement(n.p,null,t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 68.75%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe5YNg//xAAWEAADAAAAAAAAAAAAAAAAAAAAESD/2gAIAQEAAQUCHP8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGBAAAwEBAAAAAAAAAAAAAAAAAAEREEH/2gAIAQEAAT8hEKsVb4Q//9oADAMBAAIAAwAAABBQD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABkQAQADAQEAAAAAAAAAAAAAAAEAETFBIf/aAAgBAQABPxBOmzypJ5aRsgwM7ewBwn//2Q==\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="Cron"\n        title=""\n        src="/static/256daa76c02000c7c26c58ec463043c6/18e3b/cron.jpg"\n        srcset="/static/256daa76c02000c7c26c58ec463043c6/46946/cron.jpg 240w,\n/static/256daa76c02000c7c26c58ec463043c6/55489/cron.jpg 480w,\n/static/256daa76c02000c7c26c58ec463043c6/18e3b/cron.jpg 960w,\n/static/256daa76c02000c7c26c58ec463043c6/60e21/cron.jpg 1440w,\n/static/256daa76c02000c7c26c58ec463043c6/69b48/cron.jpg 1920w,\n/static/256daa76c02000c7c26c58ec463043c6/c098b/cron.jpg 2242w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\n(출처 : ",t.createElement(n.a,{href:"https://madplay.github.io/post/a-guide-to-cron-expression"},"크론 표현식(Cron Expressions)"),")"),"\n",t.createElement(n.p,null,"Cron Expression 은 위의 사진을 참고하면 이해하기 쉬울 것이다. 더 자세한 것이 알고 싶다면 출처 링크로 가보는 것을 추천한다.\nCron Expression 을 이용하면 특정 날짜, 시간 등을 지정할 수 있으며 매 시간마다, 일요일마다와 같은 주기를 설정할 수도 있다."),"\n",t.createElement(n.pre,null,t.createElement(n.code,{className:"language-java"},'private static final String CRON_EXPRESSION_EXAMPLE = "30 * * * * *";\n\n@Scheduled(cron = CRON_EXPRESSION_EXAMPLE)\npublic void cron() {\n    log.info(">>>>>시작 시간 {}", LocalDateTime.now().format(DATE_TIME_FORMATTER));\n}\n')),"\n",t.createElement(n.p,null,"위 코드는 매분 30초 마다 실행되게 Cron Expression 을 적용한 것이다."),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 8.75%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAeklEQVR42i2MWw6DIBQF3ZF60dYEFF8gKNY+9r+WaUr6cZL5ODNFbyMhfNDOcbM7jeyUohnnxBbfdL1HuRO1JJRLmdtw0cZn5kp65uXM/2lOFGbYWNeL+zjRmIDUgbLW2OnAhxed8Sj/Cx7If8o/clSWRCVDjpkhZucLFrpGQmO58rYAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="Cron_Result"\n        title=""\n        src="/static/cccc7ff4b14c52d15f2651283fbd77a7/7d769/cron-result.png"\n        srcset="/static/cccc7ff4b14c52d15f2651283fbd77a7/5243c/cron-result.png 240w,\n/static/cccc7ff4b14c52d15f2651283fbd77a7/ab158/cron-result.png 480w,\n/static/cccc7ff4b14c52d15f2651283fbd77a7/7d769/cron-result.png 960w,\n/static/cccc7ff4b14c52d15f2651283fbd77a7/87339/cron-result.png 1440w,\n/static/cccc7ff4b14c52d15f2651283fbd77a7/38cc4/cron-result.png 1760w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\n",t.createElement(n.p,null,"의도한 대로 매분 30초에 잘 실행되는 것을 확인할 수 있다."),"\n",t.createElement("br"),"\n",t.createElement(n.h3,null,"Fixed Rate"),"\n",t.createElement(n.p,null,"Fixed Rate 는 말 그대로 고정된 간격으로 실행을 해주는 것이다.\nfixedRate 값은 millisecond 단위이기 때문에 3000ms 주어 3초마다 실행되게 하였다."),"\n",t.createElement(n.pre,null,t.createElement(n.code,null,'@Scheduled(fixedRate = 3000)\npublic void fixedRate(){\n    log.info(">>>>>시작 시간 {}", LocalDateTime.now().format(DATE_TIME_FORMATTER));\n}\n')),"\n",t.createElement(n.p,null,"서버 시작과 동시에 실행되며 이후 3초의 간격으로 실행되는 것을 확인할 수 있다."),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 10%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAe0lEQVR42iXGWQ6CMBRAUdbjkEAZjTI9oK2kLRX3v5ZrkI+TnESbD8bsTNbzEI9SE1U90ouj0IHyHancTq4DaTWgTcSuX8bJk+U96lCcUtWSyByYl41hWan7lSwTnq2mE0euPYUJlHajsJG0EUQcs468Osvl1vxd76fjPxqMRWP9Vc1mAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="Fixed_Rate_Result"\n        title=""\n        src="/static/e48f33aed0b0e32e8ccf00dc6c7898b3/7d769/fixed-rate-result.png"\n        srcset="/static/e48f33aed0b0e32e8ccf00dc6c7898b3/5243c/fixed-rate-result.png 240w,\n/static/e48f33aed0b0e32e8ccf00dc6c7898b3/ab158/fixed-rate-result.png 480w,\n/static/e48f33aed0b0e32e8ccf00dc6c7898b3/7d769/fixed-rate-result.png 960w,\n/static/e48f33aed0b0e32e8ccf00dc6c7898b3/87339/fixed-rate-result.png 1440w,\n/static/e48f33aed0b0e32e8ccf00dc6c7898b3/88b03/fixed-rate-result.png 1920w,\n/static/e48f33aed0b0e32e8ccf00dc6c7898b3/6afdc/fixed-rate-result.png 2406w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\n",t.createElement(n.h3,null,"Fixed Delay"),"\n",t.createElement(n.p,null,"Fixed Delay 는 고정된 Delay 간격으로 실행이 이루어진다. 이는 Delay 기 때문에 앞의 작업이 끝난 이후부터 시간이 계산된다.\n다시 말해, fixedDelay 가 3초이고 메서드의 수행 시간이 5초라면 작업 실행 과정은 다음처럼 될 것을 기대할 수 있다."),"\n",t.createElement(n.ol,null,"\n",t.createElement(n.li,null,"0초 -> 1번 작업 시작"),"\n",t.createElement(n.li,null,"5초 -> 1번 작업 종료"),"\n",t.createElement(n.li,null,"8초 (5 + 3) -> 2번 작업 시작"),"\n"),"\n",t.createElement(n.pre,null,t.createElement(n.code,{className:"language-java"},'@Scheduled(fixedDelay = 3000)\n    public void fixedDelay() throws InterruptedException {\n    log.info(">>>>>시작 시간 {}", LocalDateTime.now().format(DATE_TIME_FORMATTER));\n    Thread.sleep(5000);\n    log.info(">>>>>종료 {}", LocalDateTime.now().format(DATE_TIME_FORMATTER));\n}\n')),"\n",t.createElement(n.p,null,"Thread 를 잠시 잠재워서 메서드 수행시간이 약 5초가 되게 하였다."),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 16.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAdElEQVR42p3OSwqDMBRAUZckTdRBP5iXvERsfoXufytXKA46LN3A4QwhNpxkfKg4fTI7xZqd8XJDU0djx7odkxo2NYxW7NaY65vxGrg/NkLsOF+ws2P4gD4j/gTlP3CVjJnWE5SMxhcSy8/D5RtMHQmFaREOVo1qirJe6AwAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="Fixed_Delay_Result"\n        title=""\n        src="/static/cffffcb8cadec7881bdff3e62923e92b/7d769/fixed-delay-result.png"\n        srcset="/static/cffffcb8cadec7881bdff3e62923e92b/5243c/fixed-delay-result.png 240w,\n/static/cffffcb8cadec7881bdff3e62923e92b/ab158/fixed-delay-result.png 480w,\n/static/cffffcb8cadec7881bdff3e62923e92b/7d769/fixed-delay-result.png 960w,\n/static/cffffcb8cadec7881bdff3e62923e92b/87339/fixed-delay-result.png 1440w,\n/static/cffffcb8cadec7881bdff3e62923e92b/0965b/fixed-delay-result.png 1772w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\n",t.createElement(n.p,null,"위에서 기대했던 바와 같이 잘 동작하는 것을 확인할 수 있다."),"\n",t.createElement(n.h3,null,"Initial Delay"),"\n",t.createElement(n.p,null,"Initial Delay 는 스케줄링 작업이 등록된 다음 얼만큼의 Delay후에 작업이 실행될건지에 대한 Delay를 정하는 것이다.\n설정을 안하게 되면 default 값이 1L 이기 때문에 스케줄링 작업이 등록되는 시점에 바로 실행된다."),"\n",t.createElement(n.p,null,"이 환경에서는 서버가 실행될 때 스케줄링 작업이 바로 등록된다."),"\n",t.createElement(n.p,null,"fixedDelay, fixedRate 와 함께 적용하는 것이 가능하다."),"\n",t.createElement(n.p,null,t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 2.083333333333333%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAUElEQVR42gXBWQqAIBRA0fYUETSB2TMtcWj4qAja/yZu5xRpe/Hh5jg/QnqoG0FLwLqd2W2o0WNsZjKRmC4WfyIm4dYDLZG2t3SDpawUZs785y8lQYTK7JcAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="cron-with-initial-delay"\n        title=""\n        src="/static/7ad0c82fee0b84d1255d3e773bbb57d8/7d769/cron-with-initial-delay.png"\n        srcset="/static/7ad0c82fee0b84d1255d3e773bbb57d8/5243c/cron-with-initial-delay.png 240w,\n/static/7ad0c82fee0b84d1255d3e773bbb57d8/ab158/cron-with-initial-delay.png 480w,\n/static/7ad0c82fee0b84d1255d3e773bbb57d8/7d769/cron-with-initial-delay.png 960w,\n/static/7ad0c82fee0b84d1255d3e773bbb57d8/87339/cron-with-initial-delay.png 1440w,\n/static/7ad0c82fee0b84d1255d3e773bbb57d8/88b03/cron-with-initial-delay.png 1920w,\n/static/7ad0c82fee0b84d1255d3e773bbb57d8/9e1eb/cron-with-initial-delay.png 2170w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\nCron Expression 과 함께 적용하는 것은 지원되지 않는 것으로 확인된다."),"\n",t.createElement("br"),"\n",t.createElement(n.h4,null,"fixedRate With Initial Delay"),"\n",t.createElement(n.p,null,"initialDelay 3초와 fixedDelay 2초의 값을 주고 실행해보았다."),"\n",t.createElement(n.pre,null,t.createElement(n.code,{className:"language-java"},'@Scheduled(fixedRate = 2000, initialDelay = 3000)\npublic void initialDelayWithFixedRate() {\n    log.info(">>>>>실행 시간 {}", LocalDateTime.now().format(DATE_TIME_FORMATTER));\n}\n')),"\n",t.createElement(n.p,null,t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 7.5%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAg0lEQVR42h3MTRKCIACAUe/TQlOwZIwwBH9AxSbr/if5mnH1di+b44GxEek77s2OkC/ya0spDLZfacxE6RbklBDDhpx3ZHifFnrgkitaPRLigXUrWe8T6uGpzBN5ixSFRtSGEL84n5CtR4yJyoYzLLsZMW6IYaVePuSNRSlHXH9oE/gDGT1GlW7Me3wAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="fixed-rate-with-initial-delay"\n        title=""\n        src="/static/0bd1b09f71de3ffabcff2f556cf1aaaa/7d769/fixed-rate-with-initial-delay.png"\n        srcset="/static/0bd1b09f71de3ffabcff2f556cf1aaaa/5243c/fixed-rate-with-initial-delay.png 240w,\n/static/0bd1b09f71de3ffabcff2f556cf1aaaa/ab158/fixed-rate-with-initial-delay.png 480w,\n/static/0bd1b09f71de3ffabcff2f556cf1aaaa/7d769/fixed-rate-with-initial-delay.png 960w,\n/static/0bd1b09f71de3ffabcff2f556cf1aaaa/87339/fixed-rate-with-initial-delay.png 1440w,\n/static/0bd1b09f71de3ffabcff2f556cf1aaaa/bb1d9/fixed-rate-with-initial-delay.png 1818w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\n서버 시작 시간(스케줄링 작업 등록 시점)으로부터 3초의 Delay 를 갖고 작업이 시작되는 것을 확인 할 수 있다."),"\n",t.createElement(n.h4,null,"fixedDelay With Initial Delay"),"\n",t.createElement(n.p,null,"위의 fixedRate 와 같은 시간 옵션을 주었다."),"\n",t.createElement(n.pre,null,t.createElement(n.code,{className:"language-java"},'@Scheduled(fixedDelay = 2000, initialDelay = 3000)\npublic void initialDelayWithFixedDelay() {\n    log.info(">>>>>실행 시간 {}", LocalDateTime.now().format(DATE_TIME_FORMATTER));\n}\n')),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 10.416666666666668%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAeUlEQVR42kXNTQ6CMBQEYC5kmuArGK3S0h8KtW1AF9z/IkN8JrqYzGq+acK0wtiMTw9uRj9GSJkgWgV1j9DjE2efQbFy5LJyhPIgqTGnN++tL7hcHZo/uGGwX5Bogew1ctnxMOmHUSigqaLLL0apMyh151MXKk7ihgNfxEdOZW0jFwAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="fixed-delay-with-initial-delay"\n        title=""\n        src="/static/b3a1bfd63ccdb2a3eac98ae8f87de7d9/7d769/fixed-delay-with-initial-delay.png"\n        srcset="/static/b3a1bfd63ccdb2a3eac98ae8f87de7d9/5243c/fixed-delay-with-initial-delay.png 240w,\n/static/b3a1bfd63ccdb2a3eac98ae8f87de7d9/ab158/fixed-delay-with-initial-delay.png 480w,\n/static/b3a1bfd63ccdb2a3eac98ae8f87de7d9/7d769/fixed-delay-with-initial-delay.png 960w,\n/static/b3a1bfd63ccdb2a3eac98ae8f87de7d9/87339/fixed-delay-with-initial-delay.png 1440w,\n/static/b3a1bfd63ccdb2a3eac98ae8f87de7d9/bb1d9/fixed-delay-with-initial-delay.png 1818w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\n",t.createElement(n.p,null,"위의 fixedRate 때와 같은 동작을 올바르게 하는 것을 확인 할 수 있다."),"\n",t.createElement(n.h3,null,"주의 할 점"),"\n",t.createElement(n.ul,null,"\n",t.createElement(n.li,null,"스케줄링 작업 메서드에는 인자값이 없어야 한다."),"\n",t.createElement(n.li,null,"서버 인스턴스가 2대 이상이라면 스케줄링 작업이 각 인스턴스에서 독립적으로 수행되기 때문에 중복 작업이 이루어질 수 있다.\n이를 방지하기 위해서는 ",t.createElement(n.code,null,"Shedlock")," 을 적용해야 하는데 자세한 내용은 다음 포스팅에서 다루어 볼 예정이다."),"\n",t.createElement(n.li,null,"Thread Pool 의 사이즈는 CPU Bound 작업인지 I/O Bound 작업인지 그리고 애플리케이션에서 사용 가능한 CPU 코어의 수 등\n여러 조건에 기반해 적절하게 설정해야 한다."),"\n"),"\n",t.createElement(n.h3,null,"마치며"),"\n",t.createElement(n.p,null,"Spring Scheduler 의 동작 방식과 적용 과정 그리고 주의해야 할 점 들에 대해 알아보았다.\n자칫하면 Spring Batch, Spring Quartz 와 혼동할 수 있는데\n각각의 기술들에 대해 장단점과 적용하는 이유와 실행되어야 하는 작업의 규모를 잘 인지하여\n적절한 기술을 적용하는 것이 중요하다. 이 포스팅에 등장한 코드들이 존재하는 프로젝트는\n",t.createElement(n.a,{href:"https://github.com/minhye0k/blog-code/tree/main/scheduler"},"전체 코드"),"에서 확인할 수 있다."))}var c=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,l.ah)(),e.components);return n?t.createElement(n,e,t.createElement(i,e)):i(e)},r=a(4765);function s(e){return t.createElement(r.Z,e,t.createElement(c,e))}r.Z}}]);
//# sourceMappingURL=component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-spring-scheduler-index-mdx-12c66e6c0f9097c96e6b.js.map