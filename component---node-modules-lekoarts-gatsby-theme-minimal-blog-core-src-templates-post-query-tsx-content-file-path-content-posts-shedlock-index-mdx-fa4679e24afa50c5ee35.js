"use strict";(self.webpackChunkminimal_blog=self.webpackChunkminimal_blog||[]).push([[286],{4765:function(e,n,t){t.d(n,{F:function(){return u},Z:function(){return p}});var l=t(7294),a=t(8733),c=t(795),r=t(1521),o=t(6799),i=t(8871);var m=e=>{let{post:n}=e;return null};const s=["16px","8px","4px"].map((e=>"rgba(0, 0, 0, 0.1) 0px "+e+" "+e+" 0px"));var d=e=>{let{data:{post:n},children:t}=e;return(0,a.tZ)(r.Z,null,(0,a.tZ)(c.X6,{as:"h1",variant:"styles.h1"},n.title),(0,a.tZ)("p",{sx:{color:"secondary",mt:3,a:{color:"secondary"},fontSize:[1,1,2]}},(0,a.tZ)("time",null,n.date),n.tags&&(0,a.tZ)(l.Fragment,null," — ",(0,a.tZ)(o.Z,{tags:n.tags})),n.timeToRead&&" — ",n.timeToRead&&(0,a.tZ)("span",null,n.timeToRead," min read")),(0,a.tZ)("section",{sx:{my:5,".gatsby-resp-image-wrapper":{my:[4,4,5],borderRadius:"4px",boxShadow:s.join(", "),".gatsby-resp-image-image":{borderRadius:"4px"}},variant:"layout.content"}},t),(0,a.tZ)(m,{post:n}))};const u=e=>{var n,t,l;let{data:{post:c}}=e;return(0,a.tZ)(i.Z,{title:c.title,description:c.description?c.description:c.excerpt,image:c.banner?null===(n=c.banner)||void 0===n||null===(t=n.childImageSharp)||void 0===t||null===(l=t.resize)||void 0===l?void 0:l.src:void 0,pathname:c.slug,canonicalUrl:c.canonicalUrl})};function p(e){let{...n}=e;return l.createElement(d,n)}},6799:function(e,n,t){var l=t(8733),a=t(7294),c=t(1883),r=t(3494),o=t(9706);n.Z=e=>{let{tags:n}=e;const{tagsPath:t,basePath:i}=(0,r.Z)();return(0,l.tZ)(a.Fragment,null,n.map(((e,n)=>(0,l.tZ)(a.Fragment,{key:e.slug},!!n&&", ",(0,l.tZ)(c.Link,{sx:e=>{var n;return{...null===(n=e.styles)||void 0===n?void 0:n.a}},to:(0,o.Z)("/"+i+"/"+t+"/"+e.slug)},e.name)))))}},8871:function(e,n,t){var l=t(7294),a=t(1883),c=t(4232);n.Z=e=>{let{title:n="",description:t="",pathname:r="",image:o="",children:i=null,canonicalUrl:m=""}=e;const s=(0,c.Z)(),{siteTitle:d,siteTitleAlt:u,siteUrl:p,siteDescription:g,siteImage:E,author:h,siteLanguage:b}=s,A={title:n?n+" | "+d:u,description:t||g,url:""+p+(r||""),image:""+p+(o||E)};return l.createElement(l.Fragment,null,l.createElement("html",{lang:b}),l.createElement("title",null,A.title),l.createElement("meta",{name:"description",content:A.description}),l.createElement("meta",{name:"image",content:A.image}),l.createElement("meta",{property:"og:title",content:A.title}),l.createElement("meta",{property:"og:url",content:A.url}),l.createElement("meta",{property:"og:description",content:A.description}),l.createElement("meta",{property:"og:image",content:A.image}),l.createElement("meta",{property:"og:type",content:"website"}),l.createElement("meta",{property:"og:image:alt",content:A.description}),l.createElement("meta",{name:"twitter:card",content:"summary_large_image"}),l.createElement("meta",{name:"twitter:title",content:A.title}),l.createElement("meta",{name:"twitter:url",content:A.url}),l.createElement("meta",{name:"twitter:description",content:A.description}),l.createElement("meta",{name:"twitter:image",content:A.image}),l.createElement("meta",{name:"twitter:image:alt",content:A.description}),l.createElement("meta",{name:"twitter:creator",content:h}),l.createElement("meta",{name:"gatsby-theme",content:"@lekoarts/gatsby-theme-minimal-blog"}),l.createElement("link",{rel:"icon",type:"image/png",sizes:"32x32",href:(0,a.withPrefix)("/favicon-32x32.png")}),l.createElement("link",{rel:"icon",type:"image/png",sizes:"16x16",href:(0,a.withPrefix)("/favicon-16x16.png")}),l.createElement("link",{rel:"apple-touch-icon",sizes:"180x180",href:(0,a.withPrefix)("/apple-touch-icon.png")}),m?l.createElement("link",{rel:"canonical",href:m}):null,i)}},2598:function(e,n,t){t.r(n),t.d(n,{Head:function(){return o.F},default:function(){return i}});var l=t(7294),a=t(1151);function c(e){const n=Object.assign({h3:"h3",hr:"hr",h4:"h4",p:"p",code:"code",ol:"ol",li:"li",h2:"h2",ul:"ul",pre:"pre",em:"em",strong:"strong",a:"a",h5:"h5",span:"span"},(0,a.ah)(),e.components);return l.createElement(l.Fragment,null,l.createElement(n.h3,null,"Scale Out 상황에서의 Spring Scheduler 중복 실행 방지"),"\n",l.createElement(n.hr),"\n",l.createElement(n.h4,null,"들어가기에 앞서"),"\n",l.createElement(n.p,null,l.createElement(n.code,null,"Spring Scheduler")," 에서는 여러 대의 인스턴스에 대한 클러스터링 기능을 제공하지 않는다.\n이 때문에 서버 인스턴스가 여러 대로 늘어나는 ",l.createElement(n.code,null,"Scale Out")," 상황에서 중복으로 실행되어 문제를 일으킬 수 있다. 이를 위해 ",l.createElement(n.code,null,"Lukas Krecan")," 님께서 만들어주신 ",l.createElement(n.code,null,"Shedlock")," 이라는 오픈소스 솔루션을 적용하면 문제를 해결할 수 있다."),"\n",l.createElement(n.hr),"\n",l.createElement(n.h4,null,"Our Goals"),"\n",l.createElement(n.ol,null,"\n",l.createElement(n.li,null,l.createElement(n.code,null,"Shedlock")," 의 적용, 사용 방법에 대한 이해"),"\n",l.createElement(n.li,null,"상황에 맞는 적절한 ",l.createElement(n.code,null,"LockProvider")," 선택 및 적용"),"\n"),"\n",l.createElement(n.hr),"\n",l.createElement(n.h2,null,"설정 및 적용 과정"),"\n",l.createElement(n.hr),"\n",l.createElement(n.h3,null,"환경"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"Spring Boot 2.5.6"),"\n",l.createElement(n.li,null,"Gradle 7.6.1"),"\n",l.createElement(n.li,null,"Java 11"),"\n"),"\n",l.createElement(n.h3,null,"적용"),"\n",l.createElement(n.ol,null,"\n",l.createElement(n.li,null,l.createElement(n.code,null,"Shedlock")," 의존성 설정"),"\n",l.createElement(n.li,null,l.createElement(n.code,null,"@EnableSchedulerLock"),", ",l.createElement(n.code,null,"@SchedulerLock")," 어노테이션 적용"),"\n",l.createElement(n.li,null,l.createElement(n.code,null,"Lock Provider")," 설정, RDB 의 경우 ",l.createElement(n.code,null,"Shedlock")," Table 생성"),"\n"),"\n",l.createElement("br"),"\n",l.createElement(n.h4,null,"의존성"),"\n",l.createElement(n.pre,null,l.createElement(n.code,null,"implementation 'net.javacrumbs.shedlock:shedlock-spring:4.44.0'\nimplementation 'net.javacrumbs.shedlock:shedlock-provider-redis-spring:4.44.0'\nimplementation 'net.javacrumbs.shedlock:shedlock-provider-jdbc-template:4.44.0'\n")),"\n",l.createElement(n.p,null,l.createElement(n.code,null,"shedlock")," 과 ",l.createElement(n.code,null,"lock provider")," 를 위한 의존성을 적용해준다.\n본 글에서는 ",l.createElement(n.code,null,"lock provider")," 의 Database 로 ",l.createElement(n.code,null,"redis"),", ",l.createElement(n.code,null,"mariadb")," 둘 다 다루어 볼 것이기 때문에 모두 추가해주었다."),"\n",l.createElement(n.p,null,l.createElement(n.em,null,"참고로 ",l.createElement(n.strong,null,"JDK 17"),", ",l.createElement(n.strong,null,"Spring 6")," 버전 이상의 환경에서는 ",l.createElement(n.strong,null,"5.1.0")," 버전을 적용해야 한다.")),"\n",l.createElement("br"),"\n",l.createElement(n.h4,null,l.createElement(n.em,null,"@EnableSchedulerLock"),", ",l.createElement(n.em,null,"@SchedulerLock")),"\n",l.createElement(n.p,null,l.createElement(n.code,null,"@EnableSchedulerLock"),"는 ",l.createElement(n.code,null,"@EnableScheduling"),"이 있는 곳에 함께 선언해주면 된다."),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-java"},'@EnableSchedulerLock(defaultLockAtLeastFor = "40s", defaultLockAtMostFor = "50s")\n@EnableScheduling\n@Configuration\n@RequiredArgsConstructor\npublic class SchedulerConfig implements SchedulingConfigurer {\n}\n')),"\n",l.createElement(n.p,null,l.createElement(n.code,null,"@SchedulerLock"),"는 ",l.createElement(n.strong,null,"Scheduling Job")," 이 수행 될 메서드에 선언해주자."),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-java"},'@SchedulerLock(name = "cron_lock", lockAtLeastFor = "20s", lockAtMostFor = "50s")\n@Scheduled(cron = CRON_EXPRESSION_EXAMPLE)\npublic void cron() {\n    log.info(">>>>>시작 시간 {}", LocalDateTime.now().format(DATE_TIME_FORMATTER));\n    log.info(">>>>>get shed lock {}", LocalDateTime.now().format(DATE_TIME_FORMATTER));\n}\n')),"\n",l.createElement(n.p,null,"위의 코드에서 등장하는 어노테이션 옵션 값들에 대해 알아보자."),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"\n",l.createElement(n.p,null,l.createElement(n.em,null,l.createElement(n.strong,null,"name"))," : ",l.createElement(n.code,null,"@SchedulerLock")," 에 필요한 옵션 값으로 Lock Name 으로 사용 할 값이다. 다른 Job 들과 중복되지 않도록 유니크하게 설정하는 것이 중요하다."),"\n"),"\n",l.createElement(n.li,null,"\n",l.createElement(n.p,null,l.createElement(n.em,null,l.createElement(n.strong,null,"defaultLockAtLeastFor, lockAtLeastFor"))," : Lock 이 유지되는 최소 시간"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"Job 의 수행 시간이 매우 빠를 때 중복 실행이 일어나는 문제를 방지할 수 있다."),"\n"),"\n"),"\n",l.createElement(n.li,null,"\n",l.createElement(n.p,null,l.createElement(n.em,null,l.createElement(n.strong,null,"defaultLockAtMostFor, lockAtMostFor"))," : Lock 이 유지되는 최대 시간"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"Job 의 수행 시간이 매우 길어지거나, 끝나지 않을 때 다음 순서의 Job 이 실행되지 않는 문제를 방지할 수 있다."),"\n"),"\n"),"\n"),"\n",l.createElement(n.p,null,"default 가 붙은 ",l.createElement(n.em,null,"defaultLockAtLeastFor"),"과 ",l.createElement(n.em,null,"defaultLockAtMostFor")," 은 ",l.createElement(n.code,null,"@EnableSchedulerLock")," 에 적용하는 값이다. 이 값은 SchedulerLock 이 걸려있지만 lockAtLeastFor 옵션이 없는 모든 Scheduling Job 에 Default 옵션으로 작용한다는 점을 주의하자."),"\n",l.createElement(n.p,null,"붙지 않은 ",l.createElement(n.em,null,"lockAtLeastFor"),", ",l.createElement(n.em,null,"lockAtMostFor")," 은 ",l.createElement(n.code,null,"@SchedulerLock")," 이 선언된 Job 에만 개별적으로 적용 되는 값이다."),"\n",l.createElement(n.p,null,l.createElement(n.em,null,l.createElement(n.strong,null,"(LockAtLeastFor 의 값이 LockAtMostFor 값보다 크면 Exception 이 발생한다.)"))),"\n",l.createElement("br"),"\n",l.createElement(n.h4,null,"Lock Provider"),"\n",l.createElement(n.p,null,"Shedlock 에서는 Redis, JDBC, Mongo, DynamoDB 등의 많은 Provider 를 제공하고 있다."),"\n",l.createElement(n.p,null,"제공되는 Provider 들과 필요한 데이터베이스 테이블 DDL 은 ",l.createElement(n.a,{href:"https://github.com/lukas-krecan/ShedLock"},"github/lukas-kracen/shedlock")," 에서 확인할 수 있다."),"\n",l.createElement(n.p,null,"의존성 부문에서 언급했던 것처럼 ",l.createElement(n.strong,null,"Redis"),", ",l.createElement(n.strong,null,"JDBC")," 에 대해서만 알아보자.\n",l.createElement(n.code,null,"Lock Provider")," 는 ",l.createElement(n.code,null,"SchedulerConfig")," 클래스에 ",l.createElement(n.code,null,"Bean")," 으로 선언해주면 된다."),"\n",l.createElement("br"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"\n",l.createElement(n.h5,null,"JDBC Lock Provider"),"\n"),"\n"),"\n",l.createElement(n.p,null,"JDBC 의 경우 ",l.createElement(n.code,null,"Shedlock")," 정보 관리를 위한 테이블을 생성해주어야 한다."),"\n",l.createElement(n.pre,null,l.createElement(n.code,null,"# MySQL, MariaDB\nCREATE TABLE shedlock(name VARCHAR(64) NOT NULL, lock_until TIMESTAMP(3) NOT NULL,\n    locked_at TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3), locked_by VARCHAR(255) NOT NULL, PRIMARY KEY (name));\n")),"\n",l.createElement(n.p,null,"본 글에서는 MariaDB 환경에서 작업이 이루어지므로 위의 DDL 을 실행하여 테이블을 생성하였다.."),"\n",l.createElement(n.p,null,"테이블 생성이 완료 되었으면 아래와 같이 ",l.createElement(n.code,null,"LockProvider")," 를 등록해주자."),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-java"},"@Bean\npublic LockProvider lockProvider(DataSource dataSource) {\n    return new JdbcTemplateLockProvider(dataSource);\n}\n")),"\n",l.createElement(n.p,null,"JDBC 를 사용할 것임으로 ",l.createElement(n.code,null,"DataSource Bean")," 을 주입받아 연동해주자."),"\n",l.createElement(n.p,null,"Schedling Job 이 실행되어 Lock 이 생성되면 데이터베이스에 다음과 같이 추가된다.\n",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 7.916666666666666%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAeElEQVR42j3JPRKCMBBAYc6irQ0IhPzsbkJgZMbaEziW3r98Tigsvua9zvmI1R0tG5JX5iXQWpPUKPsDWzd81PM1k1tIeUPqk1AORp+5L3bq2hQrRDGiZnwUkmXGaWaaHVrq2YMoURSfhGHo6fOL2/Hlqh8u8v77AWeORGl07x+aAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="shedlock-jdbc"\n        title=""\n        src="/static/6e040708733b560df6eb298a8136f70a/7d769/shedlock-jdbc.png"\n        srcset="/static/6e040708733b560df6eb298a8136f70a/5243c/shedlock-jdbc.png 240w,\n/static/6e040708733b560df6eb298a8136f70a/ab158/shedlock-jdbc.png 480w,\n/static/6e040708733b560df6eb298a8136f70a/7d769/shedlock-jdbc.png 960w,\n/static/6e040708733b560df6eb298a8136f70a/87339/shedlock-jdbc.png 1440w,\n/static/6e040708733b560df6eb298a8136f70a/0b75d/shedlock-jdbc.png 1838w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}})),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-java"},'new JdbcTemplateLockProvider(builder()\n    .withTableName("shdlck")\n    .withColumnNames(new ColumnNames("n", "lck_untl", "lckd_at", "lckd_by"))\n    .withJdbcTemplate(new JdbcTemplate(getDatasource()))\n    .withLockedByValue("my-value")\n    .withDbUpperCase(true)\n    .build())\n')),"\n",l.createElement(n.p,null,"다음과 같이 builder 를 사용하면 테이블, 스키마, 컬럼명 등을 원하는 값으로 커스터마이징 할 수 있다."),"\n",l.createElement("br"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"\n",l.createElement(n.h5,null,"Redis Lock Provider"),"\n"),"\n"),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-java"},'@Bean\npublic LockProvider lockProvider(RedisConnectionFactory redisConnectionFactory) {\n    String lockEnv = env.getProperty("spring.profiles.active");\n    return new RedisLockProvider(redisConnectionFactory, lockEnv);\n}\n')),"\n",l.createElement(n.p,null,l.createElement(n.code,null,"RedisConnectionFactory Bean")," 을 주입 받아 연동해주면 된다."),"\n",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 658px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAhUlEQVR42oXOyw6CMBQE0H6N0oc0SF8UaIUiISS68P//ZQwluDK6mGSSm5y5xN81hOqh9YAz1aDcomAGTFgw4XL37YxwW3GRHpQft+8hyvWQdYA2I64qQlYdqjpm+FSoPMLLBqLcsW3gV0jbLQhxxTg98xfz8sKQHnDNBOsSjEsf+B+2gW8O1V+QIUyYBQAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="shedlock-redis"\n        title=""\n        src="/static/7c972105fd677a70336a713203195294/0248a/shedlock-redis.png"\n        srcset="/static/7c972105fd677a70336a713203195294/5243c/shedlock-redis.png 240w,\n/static/7c972105fd677a70336a713203195294/ab158/shedlock-redis.png 480w,\n/static/7c972105fd677a70336a713203195294/0248a/shedlock-redis.png 658w"\n        sizes="(max-width: 658px) 100vw, 658px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\n",l.createElement(n.p,null,"다음과 같이 Redis 에 Key 값으로 ",l.createElement(n.code,null,"job-lock:${profile}:${lockName}")," 형태를 가진 Lock 정보가 등록 되는 것을 확인할 수 있다."),"\n",l.createElement(n.p,null,"위의 코드에서 ",l.createElement(n.strong,null,"RedisLockProvider")," 를 생성할 때 active profile 값을 가져오는데, 이 값을 넣지 않으면 ",l.createElement(n.code,null,"$(profile)")," 값에 ",l.createElement(n.strong,null,"default")," 로 들어가게 된다."),"\n",l.createElement(n.p,null,"각 환경 별로 ",l.createElement(n.code,null,"Redis")," 서버가 나누어져 있다면 상관없지만 정보 구분을 위해 명시 하는 것이 좋다고 생각한다."),"\n",l.createElement("br"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"\n",l.createElement(n.h5,null,"Lock Provider 로 in-memory DB vs disk-based DB"),"\n"),"\n"),"\n",l.createElement(n.p,null,"Shedlock 은 히스토리를 남기지 않고 Lock 유지가 필요한 시간만큼 존재하다가 지워진다. 따라서 휘발성 데이터로 관리되기 때문에 in-memory DB 를 사용하는 것이 좋다."),"\n",l.createElement(n.p,null,"하지만 굳이 이 Lock Provider 하나 때문에 in-memory DB 를 구축해야 하는 상황이라면\ndisk-based DB 를 사용하는 것 좋을 듯 하다."),"\n",l.createElement(n.h2,null,"결과"),"\n",l.createElement(n.hr),"\n",l.createElement(n.p,null,"모든 설정과 적용을 끝냈으니 이제 몇몇 상황에 대해 테스트를 하여 결과를 확인해보자."),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"\n",l.createElement(n.h3,null,"2개의 Instance 에서 중복 실행 확인"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"1번 인스턴스\n",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 10.416666666666668%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAfElEQVR42i3MWw6CMBQAUdZjYmJoCz4CasvtBYRSifvfyhgbP+ZzTiWaCZKY5g9dUNw94uzI4dhyqnuiZlx4YccNq6nULDt2ypizx4eVIWZ03GlaTxVkww8J1Z3bQ7B9xBr9gx2DJNxzxsSEkbXk5jdGN+oCLuX/oZer8AUxGEabAfZRVwAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="shedlock-first-instance"\n        title=""\n        src="/static/ef1fadab737444642b6a8537d14c99f0/7d769/shedlock-first-instance.png"\n        srcset="/static/ef1fadab737444642b6a8537d14c99f0/5243c/shedlock-first-instance.png 240w,\n/static/ef1fadab737444642b6a8537d14c99f0/ab158/shedlock-first-instance.png 480w,\n/static/ef1fadab737444642b6a8537d14c99f0/7d769/shedlock-first-instance.png 960w,\n/static/ef1fadab737444642b6a8537d14c99f0/87339/shedlock-first-instance.png 1440w,\n/static/ef1fadab737444642b6a8537d14c99f0/089e1/shedlock-first-instance.png 1866w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}})),"\n",l.createElement(n.li,null,"2번 인스턴스\n",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 15%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAqElEQVR42l3PS27DMAxFUa+n6KTVx0mB1rEtirJay3Ka7H8pN5Azy4x8AM8Du5h2JFaWfOM7KP6y4F3m7d3zaQeiVnz4wy0Vpxs2bfTrDbtU7GkmSEG0oumK60e6NrTgN98ZJL2AFzTt+LDi8n5gDe7L/bmfAyIbUXdS/qc/B7pZClMoR8PXKLgfxZp0gB9mYA4FO2aMFqysmPjETSyY08Q0r8d9+7KBD2s7aods/XclAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="shedlock-second-instance"\n        title=""\n        src="/static/5e7c2bae93f940bd10751c2157dc71d0/7d769/shedlock-second-instance.png"\n        srcset="/static/5e7c2bae93f940bd10751c2157dc71d0/5243c/shedlock-second-instance.png 240w,\n/static/5e7c2bae93f940bd10751c2157dc71d0/ab158/shedlock-second-instance.png 480w,\n/static/5e7c2bae93f940bd10751c2157dc71d0/7d769/shedlock-second-instance.png 960w,\n/static/5e7c2bae93f940bd10751c2157dc71d0/87339/shedlock-second-instance.png 1440w,\n/static/5e7c2bae93f940bd10751c2157dc71d0/39a40/shedlock-second-instance.png 1874w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}})),"\n"),"\n",l.createElement(n.p,null,"중복으로 실행을 하지 않고 사이좋게 나누어서 Job 을 수행하고 있음을 확인할 수 있다."),"\n"),"\n"),"\n",l.createElement(n.h4,null,"마치며"),"\n",l.createElement(n.p,null,"간단한 Scheduling 작업을 위해 Spring Scheduler 를 사용하는 것은 매우 편하다.\nSpring Boot Application 을 Web Server 로 띄울 때 필요한 의존성에 이미 있기 때문에 추가적으로\n설정할 게 없기 때문이다. 그리고 간단한 어노테이션과 스케줄링 옵션 적용이 주는 편리함은 크다.\n하지만 클러스터링 기능이 없기 때문에 서버 인스턴스가 여러 대로 늘어날 때 중복으로 실행되는 문제가 생긴다.\n이럴 때 적용할 수 있는 솔루션인 ",l.createElement(n.code,null,"shedlock")," 에 대해서 알아보았다."),"\n",l.createElement(n.p,null,"이 글에서 등장하는 코드의 전체는\n",l.createElement(n.a,{href:"https://github.com/minhye0k/blog-code/tree/main/scheduler"},"여기"),"에서 확인할 수 있다."),"\n",l.createElement("br"),"\n",l.createElement(n.h4,null,"참고"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,l.createElement(n.a,{href:"https://github.com/lukas-krecan/ShedLock"},"Github Repository - shedlock")),"\n"))}var r=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,a.ah)(),e.components);return n?l.createElement(n,e,l.createElement(c,e)):c(e)},o=t(4765);function i(e){return l.createElement(o.Z,e,l.createElement(r,e))}o.Z}}]);
//# sourceMappingURL=component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-shedlock-index-mdx-fa4679e24afa50c5ee35.js.map